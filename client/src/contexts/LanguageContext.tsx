import { createContext, useContext, useEffect, useState } from "react";

type Language = "uz" | "ru" | "en";

interface LanguageContextType {
  language: Language;
  setLanguage: (lang: Language) => void;
  t: (key: string) => string;
}

const translations: Record<Language, Record<string, string>> = {
  uz: {
    "app.name": "FitBoom",
    "home.welcome": "Sport hayotingizni boshqaring",
    "home.near_gyms": "Sizga eng yaqin zallar",
    "home.view_all": "Barchasini ko'rish",
    "home.sorted_by_distance": "Masofaga qarab saralangan",
    "home.nearby_gyms_desc": "Yaqin atrofdagi sport zallari",
    "home.loading": "Yuklanmoqda...",
    "home.booking_success": "Muvaffaqiyatli bron qilindi!",
    "home.credits_used": "kalit ishlatildi",
    "home.error": "Xatolik",
    "home.no_gyms_on_map": "Haritada ko'rsatish uchun koordinatali zallar yo'q",
    "home.search_results": "Qidiruv natijalari",
    "home.no_results": "Zallar topilmadi",
    "home.no_gyms_yet": "Hozircha zallar mavjud emas",
    "home.unknown_distance": "Masofa noma'lum",
    "home.my_courses": "Mening Kurslarim",
    "home.purchased": "Sotib olingan",
    "home.videos_soon": "Hozircha video kurslar mavjud emas. Tez orada yangi kurslar qo'shiladi!",
    "home.gyms_title": "Sport Zallari",
    "home.no_gyms_filter": "Sizning qidiruv shartingizga mos sport zal topilmadi",
    "home.gym_slots_title": "Bron qilish",
    "home.gym_slots_desc": "O'zingizga qulay vaqtni tanlang",
    "home.no_slots": "Vaqt slotlari yo'q. Vaqtsiz bron qilishingiz mumkin.",
    "home.confirm": "Tasdiqlash",
    
    "profile.title": "Profil",
    "profile.edit": "Tahrirlash",
    "profile.edit_title": "Profilni tahrirlash",
    "profile.name": "Ism",
    "profile.enter_name": "Ismingizni kiriting",
    "profile.save": "Saqlash",
    "profile.saving": "Saqlanmoqda...",
    "profile.user": "Foydalanuvchi",
    "profile.no_phone": "Telefon raqam yo'q",
    "profile.male": "üë® Erkak",
    "profile.female": "üë© Ayol",
    "profile.age": "yosh",
    "profile.credits_title": "Kalitlar soni",
    "profile.credits_count": "kalit",
    "profile.history_title": "Bronlar tarixi",
    "profile.no_history": "Hozircha tarix yo'q",
    "profile.unknown_gym": "Noma'lum zal",
    "profile.missed": "Muddati o'tgan",
    "profile.success_update": "Profil yangilandi",

    "settings.title": "Sozlamalar",
    "settings.admin": "Admin sifatida kirish",
    "settings.admin_desc": "Boshqaruv paneliga kirish",
    "settings.gym_owner": "Zal egasi sifatida kirish",
    "settings.gym_owner_desc": "Zalingizni boshqaring",
    "settings.partner": "Hamkor bo'lish",
    "settings.partner_desc": "Zalingizni platformaga qo'shing",
    "settings.admin_login": "Admin kirish",
    "settings.admin_login_desc": "Boshqaruv paneliga kirish uchun parolni kiriting",
    "settings.gym_owner_login": "Zal egasi kirish",
    "settings.gym_owner_login_desc": "Zalingizni boshqarish uchun kirish kodini kiriting",
    "settings.enter_password": "Parolni kiriting",
    "settings.enter_code": "Kirish kodini kiriting (masalan: ABC123)",
    "settings.login": "Kirish",
    "settings.checking": "Tekshirilmoqda...",
    "settings.hall_name": "Zal/Darslik/Dastur nomi",
    "settings.hall_placeholder": "Masalan: FitGym Chilonzor",
    "settings.phone": "Telefon raqami",
    "settings.send": "Yuborish",
    "settings.sending": "Yuborilmoqda...",
    "settings.request_sent": "So'rovingiz yuborildi. Tez orada siz bilan bog'lanamiz!",
    "settings.max_price": "Maksimal narx",
    "settings.price_filter": "Narx bo'yicha filtr...",

    "courses.title": "Video Kurslar",
    "courses.desc": "Professional video darsliklar to'plami",
    "courses.no_courses": "Hozircha video kurslar mavjud emas",
    "courses.purchased": "Sotib olingan",
    "courses.view": "Kursni Ko'rish",
    "courses.buy": "ga sotib olish",
    "courses.free": "Bepul",
    "courses.videos": "ta video",

    "map.title": "Eng Yaqin Zallar",
    "map.desc": "Haritada sport zallarni ko'ring va tanlang",
    "map.locate_me": "Mening Joylashuvim",
    "map.your_location": "Sizning joylashuvingiz",
    "map.view_on_google": "Google Maps'da ko'rish",
    "map.title_short": "Harita",

    "nav.home": "Asosiy",
    "nav.gyms": "Zallar",
    "nav.classes": "Darslar",
    "nav.bookings": "Bronlar",
    "nav.scanner": "Skaner",
    
    "common.back": "Orqaga",
    "common.save": "Saqlash",
    "common.cancel": "Bekor qilish",
    "common.error": "Xatolik",
    "common.success": "Muvaffaqiyatli",
    "common.loading": "Yuklanmoqda...",
    "common.search": "Qidirish...",
    "common.all": "Hammasi"
  },
  ru: {
    "app.name": "FitBoom",
    "home.welcome": "–£–ø—Ä–∞–≤–ª—è–π—Ç–µ —Å–≤–æ–µ–π —Å–ø–æ—Ä—Ç–∏–≤–Ω–æ–π –∂–∏–∑–Ω—å—é",
    "home.near_gyms": "–ë–ª–∏–∂–∞–π—à–∏–µ –∑–∞–ª—ã",
    "home.view_all": "–ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –≤—Å–µ",
    "home.sorted_by_distance": "–û—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–æ –ø–æ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—é",
    "home.nearby_gyms_desc": "–¢—Ä–µ–Ω–∞–∂–µ—Ä–Ω—ã–µ –∑–∞–ª—ã –ø–æ–±–ª–∏–∑–æ—Å—Ç–∏",
    "home.loading": "–ó–∞–≥—Ä—É–∑–∫–∞...",
    "home.booking_success": "–£—Å–ø–µ—à–Ω–æ –∑–∞–±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–æ!",
    "home.credits_used": "–∫–ª—é—á–µ–π –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ",
    "home.error": "–û—à–∏–±–∫–∞",
    "home.no_gyms_on_map": "–ù–µ—Ç –∑–∞–ª–æ–≤ —Å –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º–∏ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –Ω–∞ –∫–∞—Ä—Ç–µ",
    "home.search_results": "–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∏—Å–∫–∞",
    "home.no_results": "–ó–∞–ª—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã",
    "home.no_gyms_yet": "–ó–∞–ª—ã –ø–æ–∫–∞ –Ω–µ –¥–æ–±–∞–≤–ª–µ–Ω—ã",
    "home.unknown_distance": "–†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–æ",
    "home.my_courses": "–ú–æ–∏ –ö—É—Ä—Å—ã",
    "home.purchased": "–ö—É–ø–ª–µ–Ω–æ",
    "home.videos_soon": "–í–∏–¥–µ–æ–∫—É—Ä—Å—ã –ø–æ–∫–∞ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã. –°–∫–æ—Ä–æ –ø–æ—è–≤—è—Ç—Å—è –Ω–æ–≤—ã–µ –∫—É—Ä—Å—ã!",
    "home.gyms_title": "–°–ø–æ—Ä—Ç–∏–≤–Ω—ã–µ –ó–∞–ª—ã",
    "home.no_gyms_filter": "–ó–∞–ª—ã –ø–æ –≤–∞—à–µ–º—É –∑–∞–ø—Ä–æ—Å—É –Ω–µ –Ω–∞–π–¥–µ–Ω—ã",
    "home.gym_slots_title": "–ë—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ",
    "home.gym_slots_desc": "–í—ã–±–µ—Ä–∏—Ç–µ —É–¥–æ–±–Ω–æ–µ –≤—Ä–µ–º—è",
    "home.no_slots": "–ù–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —Å–ª–æ—Ç–æ–≤. –í—ã –º–æ–∂–µ—Ç–µ –∑–∞–±—Ä–æ–Ω–∏—Ä–æ–≤–∞—Ç—å –±–µ–∑ –≤—ã–±–æ—Ä–∞ –≤—Ä–µ–º–µ–Ω–∏.",
    "home.confirm": "–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å",

    "profile.title": "–ü—Ä–æ—Ñ–∏–ª—å",
    "profile.edit": "–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å",
    "profile.edit_title": "–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ—Ñ–∏–ª—å",
    "profile.name": "–ò–º—è",
    "profile.enter_name": "–í–≤–µ–¥–∏—Ç–µ –≤–∞—à–µ –∏–º—è",
    "profile.save": "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å",
    "profile.saving": "–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ...",
    "profile.user": "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å",
    "profile.no_phone": "–ù–µ—Ç –Ω–æ–º–µ—Ä–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–∞",
    "profile.male": "üë® –ú—É–∂—á–∏–Ω–∞",
    "profile.female": "üë© –ñ–µ–Ω—â–∏–Ω–∞",
    "profile.age": "–ª–µ—Ç",
    "profile.credits_title": "–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–ª—é—á–µ–π",
    "profile.credits_count": "–∫–ª—é—á–µ–π",
    "profile.history_title": "–ò—Å—Ç–æ—Ä–∏—è –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–π",
    "profile.no_history": "–ò—Å—Ç–æ—Ä–∏–∏ –ø–æ–∫–∞ –Ω–µ—Ç",
    "profile.unknown_gym": "–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π –∑–∞–ª",
    "profile.missed": "–ü—Ä–æ—Å—Ä–æ—á–µ–Ω–æ",
    "profile.success_update": "–ü—Ä–æ—Ñ–∏–ª—å –æ–±–Ω–æ–≤–ª–µ–Ω",

    "settings.title": "–ù–∞—Å—Ç—Ä–æ–π–∫–∏",
    "settings.admin": "–í–æ–π—Ç–∏ –∫–∞–∫ –∞–¥–º–∏–Ω",
    "settings.admin_desc": "–î–æ—Å—Ç—É–ø –∫ –ø–∞–Ω–µ–ª–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è",
    "settings.gym_owner": "–í–æ–π—Ç–∏ –∫–∞–∫ –≤–ª–∞–¥–µ–ª–µ—Ü –∑–∞–ª–∞",
    "settings.gym_owner_desc": "–£–ø—Ä–∞–≤–ª—è–π—Ç–µ –≤–∞—à–∏–º –∑–∞–ª–æ–º",
    "settings.partner": "–°—Ç–∞—Ç—å –ø–∞—Ä—Ç–Ω–µ—Ä–æ–º",
    "settings.partner_desc": "–î–æ–±–∞–≤—å—Ç–µ –≤–∞—à –∑–∞–ª –Ω–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º—É",
    "settings.admin_login": "–í—Ö–æ–¥ –¥–ª—è –∞–¥–º–∏–Ω–∞",
    "settings.admin_login_desc": "–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –ø–∞–Ω–µ–ª–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è",
    "settings.gym_owner_login": "–í—Ö–æ–¥ –¥–ª—è –≤–ª–∞–¥–µ–ª—å—Ü–∞ –∑–∞–ª–∞",
    "settings.gym_owner_login_desc": "–í–≤–µ–¥–∏—Ç–µ –∫–æ–¥ –¥–æ—Å—Ç—É–ø–∞ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–∞–ª–æ–º",
    "settings.enter_password": "–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å",
    "settings.enter_code": "–í–≤–µ–¥–∏—Ç–µ –∫–æ–¥ –¥–æ—Å—Ç—É–ø–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä: ABC123)",
    "settings.login": "–í–æ–π—Ç–∏",
    "settings.checking": "–ü—Ä–æ–≤–µ—Ä–∫–∞...",
    "settings.hall_name": "–ù–∞–∑–≤–∞–Ω–∏–µ –∑–∞–ª–∞/–∫—É—Ä—Å–∞/–ø—Ä–æ–≥—Ä–∞–º–º—ã",
    "settings.hall_placeholder": "–ù–∞–ø—Ä–∏–º–µ—Ä: FitGym –ß–∏–ª–∞–Ω–∑–∞—Ä",
    "settings.phone": "–ù–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞",
    "settings.send": "–û—Ç–ø—Ä–∞–≤–∏—Ç—å",
    "settings.sending": "–û—Ç–ø—Ä–∞–≤–∫–∞...",
    "settings.request_sent": "–í–∞—à –∑–∞–ø—Ä–æ—Å –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω. –ú—ã —Å–≤—è–∂–µ–º—Å—è —Å –≤–∞–º–∏ –≤ –±–ª–∏–∂–∞–π—à–µ–µ –≤—Ä–µ–º—è!",
    "settings.max_price": "–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Ü–µ–Ω–∞",
    "settings.price_filter": "–§–∏–ª—å—Ç—Ä –ø–æ —Ü–µ–Ω–µ...",

    "courses.title": "–í–∏–¥–µ–æ –ö—É—Ä—Å—ã",
    "courses.desc": "–ö–æ–ª–ª–µ–∫—Ü–∏—è –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã—Ö –≤–∏–¥–µ–æ—É—Ä–æ–∫–æ–≤",
    "courses.no_courses": "–í–∏–¥–µ–æ–∫—É—Ä—Å—ã –ø–æ–∫–∞ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã",
    "courses.purchased": "–ö—É–ø–ª–µ–Ω–æ",
    "courses.view": "–°–º–æ—Ç—Ä–µ—Ç—å –∫—É—Ä—Å",
    "courses.buy": "–∫—É–ø–∏—Ç—å –∑–∞",
    "courses.free": "–ë–µ—Å–ø–ª–∞—Ç–Ω–æ",
    "courses.videos": "–≤–∏–¥–µ–æ",

    "map.title": "–ë–ª–∏–∂–∞–π—à–∏–µ –∑–∞–ª—ã",
    "map.desc": "–°–º–æ—Ç—Ä–∏—Ç–µ –∏ –≤—ã–±–∏—Ä–∞–π—Ç–µ –∑–∞–ª—ã –Ω–∞ –∫–∞—Ä—Ç–µ",
    "map.locate_me": "–ú–æ–µ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ",
    "map.your_location": "–í–∞—à–µ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ",
    "map.view_on_google": "–ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –Ω–∞ Google Maps",
    "map.title_short": "–ö–∞—Ä—Ç–∞",

    "nav.home": "–ì–ª–∞–≤–Ω–∞—è",
    "nav.gyms": "–ó–∞–ª—ã",
    "nav.classes": "–ó–∞–Ω—è—Ç–∏—è",
    "nav.bookings": "–ë—Ä–æ–Ω–∏",
    "nav.scanner": "–°–∫–∞–Ω–µ—Ä",

    "common.back": "–ù–∞–∑–∞–¥",
    "common.save": "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å",
    "common.cancel": "–û—Ç–º–µ–Ω–∞",
    "common.error": "–û—à–∏–±–∫–∞",
    "common.success": "–£—Å–ø–µ—à–Ω–æ",
    "common.loading": "–ó–∞–≥—Ä—É–∑–∫–∞...",
    "common.search": "–ü–æ–∏—Å–∫...",
    "common.all": "–í—Å–µ"
  },
  en: {
    "app.name": "FitBoom",
    "home.welcome": "Manage your sports life",
    "home.near_gyms": "Gyms near you",
    "home.view_all": "View all",
    "home.sorted_by_distance": "Sorted by distance",
    "home.nearby_gyms_desc": "Gyms in your vicinity",
    "home.loading": "Loading...",
    "home.booking_success": "Successfully booked!",
    "home.credits_used": "credits used",
    "home.error": "Error",
    "home.no_gyms_on_map": "No gyms with coordinates to display on map",
    "home.search_results": "Search results",
    "home.no_results": "No gyms found",
    "home.no_gyms_yet": "No gyms available yet",
    "home.unknown_distance": "Distance unknown",
    "home.my_courses": "My Courses",
    "home.purchased": "Purchased",
    "home.videos_soon": "No video courses available yet. New courses coming soon!",
    "home.gyms_title": "Gyms",
    "home.no_gyms_filter": "No gyms found matching your search",
    "home.gym_slots_title": "Booking",
    "home.gym_slots_desc": "Choose a convenient time",
    "home.no_slots": "No time slots available. You can book without a specific time.",
    "home.confirm": "Confirm",

    "profile.title": "Profile",
    "profile.edit": "Edit",
    "profile.edit_title": "Edit Profile",
    "profile.name": "Name",
    "profile.enter_name": "Enter your name",
    "profile.save": "Save",
    "profile.saving": "Saving...",
    "profile.user": "User",
    "profile.no_phone": "No phone number",
    "profile.male": "üë® Male",
    "profile.female": "üë© Female",
    "profile.age": "years old",
    "profile.credits_title": "Credit Balance",
    "profile.credits_count": "credits",
    "profile.history_title": "Booking History",
    "profile.no_history": "No history yet",
    "profile.unknown_gym": "Unknown Gym",
    "profile.missed": "Expired",
    "profile.success_update": "Profile updated",

    "settings.title": "Settings",
    "settings.admin": "Login as Admin",
    "settings.admin_desc": "Access management panel",
    "settings.gym_owner": "Login as Gym Owner",
    "settings.gym_owner_desc": "Manage your gym",
    "settings.partner": "Become a Partner",
    "settings.partner_desc": "Add your gym to the platform",
    "settings.admin_login": "Admin Login",
    "settings.admin_login_desc": "Enter password to access the management panel",
    "settings.gym_owner_login": "Gym Owner Login",
    "settings.gym_owner_login_desc": "Enter access code to manage your gym",
    "settings.enter_password": "Enter password",
    "settings.enter_code": "Enter access code (e.g., ABC123)",
    "settings.login": "Login",
    "settings.checking": "Checking...",
    "settings.hall_name": "Gym/Course/Program Name",
    "settings.hall_placeholder": "e.g., FitGym Chilonzor",
    "settings.phone": "Phone Number",
    "settings.send": "Send",
    "settings.sending": "Sending...",
    "settings.request_sent": "Your request has been sent. We will contact you soon!",
    "settings.max_price": "Max price",
    "settings.price_filter": "Price filter...",

    "courses.title": "Video Courses",
    "courses.desc": "Professional video tutorial collections",
    "courses.no_courses": "No video courses available yet",
    "courses.purchased": "Purchased",
    "courses.view": "View Course",
    "courses.buy": "buy for",
    "courses.free": "Free",
    "courses.videos": "videos",

    "map.title": "Gyms Near You",
    "map.desc": "See and select gyms on the map",
    "map.locate_me": "My Location",
    "map.your_location": "Your location",
    "map.view_on_google": "View on Google Maps",
    "map.title_short": "Map",

    "nav.home": "Home",
    "nav.gyms": "Gyms",
    "nav.classes": "Classes",
    "nav.bookings": "Bookings",
    "nav.scanner": "Scanner",

    "common.back": "Back",
    "common.save": "Save",
    "common.cancel": "Cancel",
    "common.error": "Error",
    "common.success": "Success",
    "common.loading": "Loading...",
    "common.search": "Search...",
    "common.all": "All"
  }
};

const LanguageContext = createContext<LanguageContextType | undefined>(undefined);

export function LanguageProvider({ children }: { children: React.ReactNode }) {
  const [language, setLanguageState] = useState<Language>(
    (localStorage.getItem("language") as Language) || "uz"
  );

  const setLanguage = (lang: Language) => {
    setLanguageState(lang);
    localStorage.setItem("language", lang);
  };

  const t = (key: string) => {
    return translations[language][key] || key;
  };

  return (
    <LanguageContext.Provider value={{ language, setLanguage, t }}>
      {children}
    </LanguageContext.Provider>
  );
}

export function useLanguage() {
  const context = useContext(LanguageContext);
  if (!context) {
    throw new Error("useLanguage must be used within a LanguageProvider");
  }
  return context;
}
